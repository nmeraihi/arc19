<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Télématique UQAM-COOP</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Noureddine Meraihi">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/simple.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
		<!-- percentage animation -->
		<link rel="stylesheet" href="css/percent.css" type="text/css">


		<!-- FondAwosom -->

		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

		<!--  google font-->
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">


		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section>
					<h1>Télématique</h1>
					<h3>Fréquence des sinistres par GBMP</h3>
					<p>
						<small>Par <a href="https://www.linkedin.com/in/nmeraihi">Noureddine Meraihi</a> </small>
					</p>

					<a href="http://nour.me/"><i style="font-size:36px" class="fa">&#xf05a; </i></a>
					<a href="https://www.linkedin.com/in/nmeraihi"><i style="font-size:36px" class="fa">&#xf08c; </i></a>
					<a href="https://github.com/nmeraihi"><i style="font-size:36px" class="fa">&#xf092; </i></a>
					<!-- <a href="https://www.strava.com/athletes/20294970"><i style="font-size:36px" class="fa">&#xf428; </i></i></a> -->
					<p><small>Sous la supervision de <a href="http://jpboucher.uqam.ca/">Jean-Philippe Boucher</a></small></p>
					<p><small>En collaboration avec <a href="https://www.cooperators.ca/">Co-operators</a></small></p>
				</section>

				<section>

					<h2>L'apprentissage par arbres de décision</h2>
					<br>
					<p class="fragment">Classification</p>
						<!-- <p class="fragment grow">grow</p> -->
					<p class="fragment">Régression </p>
				</section>

				<section>
					<h2>Classification</h2>
					<br>
					<p class="fragment">Permettent classifier une valeur</p>
				</section>
				<section>
					<h2>Régression</h2>
					<br>
					<p class="fragment">permettent de prédire une valeur numérique</p>
				</section>

				<section>
					<section>
						<h2>Exemple</h2>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/basebal_scat_3.png">
					</section>
					<section data-background-transition="zoom">
						<img src="https://s3.amazonaws.com/noureddine/basebal_scat_4.png">
						 <p style="font-size:70%" class="fragment">$$R_1=\left( \mathbf{Y} | \mathbf{X_2} \leq 4,5 \right)=\exp(5,1068)=165 \ 114 \ \$$$</p>
						<p style="font-size:70%" class="fragment">$$R_2=\left( \mathbf{Y} | \mathbf{X_2} > 4,5 \ ,\mathbf{X_1} \leq 117,5 \right) =402 \ 783 \ \$$$</p>
						<p style="font-size:70%" class="fragment">$$R_3=\left( \mathbf{Y} | \mathbf{X_2} > 4,5 \ ,\mathbf{X_1} > 117,5 \right)=845 \ 307 \ \$$$</p>
						<aside class="notes">
							On peut calculer R1-R3
						</aside>
					</section>
					<section>
						<img src="https://s3.amazonaws.com/noureddine/basebal_tree_2.png">
						<aside class="notes">
							Si un nouveau joueur arrive, on peut alors estimer ce qu'il vaut, seulement avec ces infos
							--
						</aside>
					</section>
					<section>
						<h3>Avantages</h3>
						<p style="font-size:70%" class="fragment">Très intuitifs</p>

						<p style="font-size:70%"class="fragment">Des prédictions acceptables</p>
						<p><span class="fragment">lorsque</span> <span class="fragment">données</span> <span class="fragment">homogènes.</span></p>

					</section>



					<section>
						<h3 class="fragment">Inconvénients</h3>
						<p style="font-size:70%" class="fragment">Très sensible aux données</p>
						<p><span style="font-size:70%" class="fragment">En présence de</span> <span style="font-size:70%" class="fragment">valeurs</span> <span style="font-size:70%" class="fragment" >aberrantes.</span></p>

					</section>
				</section>


				<!-- <section>
					<section>
						<h2>Bootstrap</h2>
						<p style="font-size:70%" class="fragment">Les années 1970</p>
						<p style="font-size:70%" class="fragment">crée de nouveaux échantillons avec remise</p>
						<p style="font-size:70%" class="fragment">mesurer la sensibilité des estimations (variance, écart-type)</p>
					</section>

					<section>
					<h3>Bootstrap aggregating (Bagging)</h3>
					<p style="font-size:70%" class="fragment">Par <a href="https://link.springer.com/article/10.1007/BF00058655">(Breiman, 1996)</a></p>
					<p><span style="font-size:70%" class="fragment">L'idée:</span> <span style="font-size:70%" class="fragment">Un échantillon</span> <span style="font-size:70%" class="fragment" >d'arbres de régression.</span></p>
					<img class="fragment" src="https://s3.amazonaws.com/noureddine/ensemblistes_3_3.png" height="300" width="500">
					</section>

					<section>
					<h3>Random Forest</h3>
					<p style="font-size:70%" class="fragment">Par <a href="https://www.researchgate.net/profile/Andy_Liaw/publication/228451484_Classification_and_Regression_by_RandomForest/links/53fb24cc0cf20a45497047ab/Classification-and-Regression-by-RandomForest.pdf">(Breiman, 2001)</a></p>
					<p><span style="font-size:70%" class="fragment">L'idée:</span> <span style="font-size:70%" class="fragment">Ajouter une composante</span> <span style="font-size:70%" class="fragment" >aléatoire.</span></p>
					<p tyle="font-size:90%" class="fragment">afin de rendre les arbres de décision plus indépendants  </p>
					<img class="fragment" src="https://dsc-spidal.github.io/harp/img/4-5-1.png">
					</section>

					<section>
						<h3>Boosting</h3>
						<p style="font-size:70%" class="fragment">Weak learner</p>
						<p style="font-size:70%" class="fragment">On calcule l'erreur </p>
						<aside class="notes">
							On cacule l'erreur avec la méthode des moindres carrés par exemple
						</aside>
						<p style="font-size:70%" class="fragment">On apprend par ses erreurs</p>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/ensemblistes_3_2.jpg">



					</section>
				</section> -->


				<section>
					<section>
						<h3>Gradient Boosting Machine</h3>
						<p style="font-size:70%" class="fragment">Par <a href="https://www.jstor.org/stable/2699986?seq=1#page_scan_tab_contents">(Friedman, 2001)</a></p>
						<p style="font-size:70%" class="fragment">fonction de déviance des distributions statistiques</p>
						<p style="font-size:70%" class="fragment">La naissance du statistical learning</p>

					</section>
					<section>
							<h3>Exemple</h3>
							<img class="fragment" src="https://s3.amazonaws.com/noureddine/gbm_from_scra_1.png">
					</section>
					<section>
						<img src="https://s3.amazonaws.com/noureddine/gbm_from_scra_2.png">
					</section>
					<section>
						<img src="https://s3.amazonaws.com/noureddine/gbm_from_scra.png">
					</section>
					<section>
						<img src="https://s3.amazonaws.com/noureddine/gbm_from_scra_3.png">
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/gbm_from_scra_4.png">
					</section>
					<section>
						<img src="https://s3.amazonaws.com/noureddine/gbm_from_scra_16.png">
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/gbm_from_scra_30.png">
					</section>
					<section>
							<h3>GBM</h3>
							<img class="fragment" src="https://s3.amazonaws.com/noureddine/gbm.png" height="500" width="700">
							<aside class="notes">
								On a dit qu'on pouvait utiliser n'importe quel fonction  de perte
							</aside>
					</section>
					<section>
							<h3>GBMP</h3>
							<img class="fragment" src="https://s3.amazonaws.com/noureddine/GBMP.png" height="500" width="700">
					</section>
				</section>


				<section>
					<!-- les données -->
					<section>
						<h3>Données démographiques</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/sexe_satut_martial.png" height="500" width="500">
					</section>

					<section>
						<h3>Code postal</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/codes_postaux.png" height="500" width="500">
					</section>

					<section>
						<h3>Densité par région </h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/population_1.png">
					</section>

					<section>
						<h3>Habitudes de conduite</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/week_end_rush.png" height="500" width="500">
					</section>

					<section>
						<img src="https://s3.amazonaws.com/noureddine/conduite_pourcentage.png" height="500" width="500">
					</section>
				</section>

				<section>
					<section>
						<h3>Région de Toronto</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/map_distance_driven_zoom.png" height="500" width="500">
					</section>
					<section>
						<h3>Région d'Ottawa</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/map_distance_driven_zoom_2.png" height="500" width="500">
					</section>

				</section>


				<section>
					<h3>Données sur le véhicule</h3>
					<img class="fragment" src="https://s3.amazonaws.com/noureddine/vehicule_type.png" height="500" width="500">
				</section>


				<section>
					<section>
						<h3>Nombre de sinistres</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/frequence.png" height="200" width="800">
						<aside class="notes">
							les gens qui ont eu un sinistre ont conduit 5.52% de la distance total parcourue
						</aside>
					</section>

					<section>
						<h3>Au moins un sinistre</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/sin_pg_0_2.png" height="400" width="500">
						<aside class="notes">
							Ici le 2972 c'est la région de Toronto et de Mississauga
						</aside>
					</section>

					<section>
						<h3>Deux sinistres ou plus</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/sin_pg_1_2.png" height="350" width="500">
					</section>

					<section>
						<h3>Trois sinistres</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/sin_pg_2_2.png" height="350" width="500">
					</section>
				</section>



				<section>
					<section>
						<h2>Modélisation de la fréquence des réclamations</h2>
					</section>

					<section>
						<h3>La corrélation</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/correlation.png" height="500" width="500">
					</section>
					<section>
						<h3>La corrélation</h3>
						<img src="https://s3.amazonaws.com/noureddine/correlation_2.png" height="500" width="500">
						<aside class="notes">
							y'en a qui sont évident: exposition vs la distance parcourue
							--
							Le nombre d'années sans sinistres vs le nombre d'années permis
							---
							correation negative: % conduite mercredi-Jeudi -vs samedi-doimanche
						</aside>
					</section>

					<section>
						<h3>Partitionnement des données</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/trainTest2.png" height="500" width="550">
					</section>

					<section>
						<h3>Convergence - GPU</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/convergence.png" height="400" width="550">
					</section>

				</section>


				<section>
					<section>
						<h2>interprétation des résultats</h2>
					</section>
					<section>
						<h3>Importance des variables</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/algo_VI_perm.png" height="500" width="700">
					</section>
					<section>
						<img src="https://s3.amazonaws.com/noureddine/VI_perm_1.png" height="240" width="800">
						<h4 class="fragment">On calcule l'erreur</h4>
					</section>
					<section>
						<h3>2e variable</h3>
						<img src="https://s3.amazonaws.com/noureddine/VI_perm_2.png" height="240" width="800">
						<h4 class="fragment">On calcule l'erreur</h4>
					</section>
					<section>
						<h3>Une variable "importante"</h3>
						<p><span class="fragment">est une variable qui a produit</span> <span class="fragment">la plus grande</span>
							<span class="fragment"><span class="fragment highlight-red">erreur.</span></span>
							</p>
					</section>
					<section>
						<img src="https://s3.amazonaws.com/noureddine/LGBM.png" height="500" width="500">
						<aside class="notes">
							On a découpé la distance parcourrue en 1000 ...
						</aside>
					</section>
				</section>

				<section>
					<section>
						<h3>Distribution des sinistres (Train)</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/dep_part_km.png" height="350" width="600">
					</section>
					<section>
						<h3>Dépendance partielle (PDP)</h3>
						<img src="https://s3.amazonaws.com/noureddine/PDP.png" height="500" width="600">
					</section>
					<section>
						<h3>PDP top_7</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/PDP_top_10.png" height="500" width="600">
					</section>
				</section>



				<section>
					<section>
						<h3>Prédiction</h3>
					</section>
					<section >
						<h3>Kilométrage parcouru</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/obs_dist.png" height="250" width="600">
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/pred_dist.png" height="250" width="600">
					</section>
					<section>
						<img src="https://s3.amazonaws.com/noureddine/pdp_dist_pred_test.png" height="300" width="700">
					</section>

					<!-- <section >
						<h3>Exposition en jour</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/pdp_exp_pred_test.png" height="300" width="700">
					</section>

					<section >
						<h3>Âge du véhicule</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/pdp_va_pred_test.png" height="300" width="700">
					</section>

					<section >
						<h3>Pourcentage d'utilisation</h3>
						<h4 class="fragment" ><i>Percent day of use</i></h4>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/pdp_pourcentage_utilisation_pred_test.png" height="300" width="700">
					</section>

					<section >
						<h4>Nombre de jours d'utilisation moyen par semaine</h4>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/pdp_avgDayUseWeek_pred_test.png" height="300" width="700">
					</section>

					<section >
						<h4>La moyenne du nombre d’heures de conduite</h4>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/pdp_avgHoursDriven_pred_test.png" height="300" width="700">
					</section>

					<section >
						<h4>Nombre de voyages moyen par semaine</h4>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/pdp_avgweekNbtrip_pred_test.png" height="300" width="700">
					</section> -->

				</section>

				<section>
					<section>
						<h3>Les valeurs Shapley</h3>
						<p style="font-size:70%" class="fragment">basé sur les valeurs de Shapley <a href="https://books.google.ca/books?hl=en&lr=&id=Pd3TCwAAQBAJ&oi=fnd&pg=PA307&dq=Shapley,+1953&ots=gsr_D95jqX&sig=uO5klbnmkfw7ZfIYdmmR2Q4kGKY#v=onepage&q=Shapley%2C%201953&f=false">(Shapley, 1953)</a></p>
						<p style="font-size:70%" class="fragment">une technique utilisée en <span class="fragment highlight-blue">théorie des jeux</span></p>
						<p style="font-size:70%" class="fragment">Une méthode d’attribution des paiements aux joueurs en fonction de leur <span class="fragment highlight-blue">contribution</span> au paiement total</p>
					</section>

					<section>
						<h3 style="font-size:80%" class="fragment">Prenons trois assurés dans notre base de données</h3>
						<h3 style="font-size:80%" class="fragment">selon leur kilométrage parcouru</h3>
					</section>

					<section >
						<h4>Beaucoup de km</h4>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/SHAP_km_max.png" height="150" width="800">
					</section>

					<section >
						<h4>Très peu de km</h4>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/SHAP_km_min.png" height="150" width="800">
					</section>

					<section >
						<h4>kilométrage moyen</h4>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/SHAP_km_moyen.png" height="150" width="800">
						<aside class="notes">
							La valeur prédite est semblable malgré la grande différence de km parcouru
							car les valeur Shapely tiennent compte de toutes les variables
						</aside>
					</section>

					<section >
						<h4>Verticalement</h4>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/milles_premier_assures.png" height="150" width="800">
					</section>

					<section>
						<h5>Dispersion de densité des valeurs Shapely</h5>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/SHAP_impact_on_model.png" height="300" width="500">
						<aside class="notes">
On peut voir que la distance parcourue a influé sur plus de prédiction dans une large mesure,
alors que l’exposition en jour influe sur moins de prédictions et dans une moindre mesure.
Toutefois, si l’on compare cette variable à l’âge du véhicule, on voit cette dernière
caractéristique influe le modèle sur plus de prédictions, mais dans une mesure
plus ou moins égale lorsqu’on compare en valeur absolue sur l’axe des x,
soit l’impact sur le modèle. Lorsque les points de dispersion ne tiennent
pas sur une ligne, ils s’empilent pour montrer la densité, et la couleur
de chaque point représente la valeur de la caractéristique de cet individu.
						</aside>
						<p style="font-size:50%" class="fragment">La couleur nous permet d’apparier la façon dont les changements de valeur d’une variable influent sur la variable prédite</p>
					</section>


					<section>
						<h4>Interaction des variables par SHAP</h4>
						<p><span style="font-size:70%" class="fragment">Lorsqu'on deux variables</span> <span style="font-size:70%" class="fragment">, on peut décomposer la prédiction en quatre termes</span></p>
						<ul>
							<li style="font-size:70%" class="fragment">un terme constant</li>
							<li style="font-size:70%" class="fragment">un terme pour la première variable</li>
							<li style="font-size:70%" class="fragment">un terme pour la deuxième variable</li>
							<li style="font-size:70%" class="fragment">et un terme pour l’effet d’interaction entre les deux variables.</li>
						</ul>
					</section>

					<section>
						<p style="font-size:70%" >Nous traçons alors un graphique récapitulatif d’une matrice de valeurs d’interaction avec les principaux effets sur la diagonale et les effets d’interaction hors diagonale</p>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/unteraction_sommaire.png" height="300" width="500">
					</section>
					<section>
						<h3>L'effet principal du km</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/interaction_princip_distance.png" height="350" width="500">
					</section>

					<section>
						<h3>Effets d’interaction entre la variable distance parcourue et l’âge du véhicule</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/effet_principaux.png?raw=true" >
																			                   /nmeraihi/blog/blob/master/images/results.png?raw=true
					</section>

					<section>
						<h3>PDP sur les effets d’interaction entre la variable distance parcourue et l’âge du véhicule</h3>
						<img class="fragment" src="https://s3.amazonaws.com/noureddine/interaction.png?raw=true" >
					</section>
				</section>

				<section>
				<h3>Quelques scores</h3>
				<img class="fragment" src="https://s3.amazonaws.com/noureddine/scores.png?raw=true" height="300" width="500">
				</section>

				<section>
				<h3>Les prédictions</h3>
				<img class="fragment" src="https://s3.amazonaws.com/noureddine/results.png?raw=true">
				</section>

				<section>
					<h2>Merci!</h2>
					<a href="http://nour.me/"><i style="font-size:36px" class="fa">&#xf05a; </i></a>
					<a href="https://www.linkedin.com/in/nmeraihi"><i style="font-size:36px" class="fa">&#xf08c; </i></a>
					<a href="https://github.com/nmeraihi"><i style="font-size:36px" class="fa">&#xf092; </i></a>

				</section>












			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>


		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
				math: {
				mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
				config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
			},
			multiplex: {
			  // Example values. To generate your own, see the socket.io server instructions.
			  secret: null, // Obtained from the socket.io server. Gives this (the master) control of the presentation
			  id: 'c764d66a380e7ba4', // Obtained from socket.io server
			  url: 'https://reveal-js-multiplex-ccjbegmaii.now.sh' // Location of socket.io server
			},
				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/search/search.js', async: true },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/math/math.js', async: true },
					{ src: '//cdn.socket.io/socket.io-1.3.5.js', async: true },
					{ src: 'plugin/multiplex/client.js', async: true }
				]
			});

		</script>

	</body>
</html>
